<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>SQL必知必会 | GN</title><meta name="description" content="SQL必知必会"><meta name="author" content="GN"><meta name="copyright" content="GN"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="SQL必知必会"><meta name="twitter:description" content="SQL必知必会"><meta name="twitter:image" content="http://img5.imgtn.bdimg.com/it/u=2251006597,1398776092&amp;fm=26&amp;gp=0.jpg"><meta property="og:type" content="article"><meta property="og:title" content="SQL必知必会"><meta property="og:url" content="http://lmzcool.top/2020/04/06/sql/"><meta property="og:site_name" content="GN"><meta property="og:description" content="SQL必知必会"><meta property="og:image" content="http://img5.imgtn.bdimg.com/it/u=2251006597,1398776092&amp;fm=26&amp;gp=0.jpg"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://lmzcool.top/2020/04/06/sql/"><link rel="prev" title="iOS图片移到assets问题记录" href="http://lmzcool.top/2020/04/10/image_assets/"><link rel="next" title="SQLite常用API（C）" href="http://lmzcool.top/2020/04/06/SQLite%E5%B8%B8%E7%94%A8API(C)/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: false,
  highlightLang: false,
  highlightShrink: 'none',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">15</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">4</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-数据库基础"><span class="toc-number">1.</span> <span class="toc-text">1. 数据库基础</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-检索数据"><span class="toc-number">2.</span> <span class="toc-text">2. 检索数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-排序检索数据"><span class="toc-number">3.</span> <span class="toc-text">3. 排序检索数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-过滤数据"><span class="toc-number">4.</span> <span class="toc-text">4. 过滤数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-高级数据过滤"><span class="toc-number">5.</span> <span class="toc-text">5. 高级数据过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-用通配符进行过滤"><span class="toc-number">6.</span> <span class="toc-text">6. 用通配符进行过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-创建计算字段"><span class="toc-number">7.</span> <span class="toc-text">7. 创建计算字段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-使用函数处理数据"><span class="toc-number">8.</span> <span class="toc-text">8. 使用函数处理数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#文本处理函数"><span class="toc-number">8.1.</span> <span class="toc-text">文本处理函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数值处理函数"><span class="toc-number">8.2.</span> <span class="toc-text">数值处理函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#日期处理函数"><span class="toc-number">8.3.</span> <span class="toc-text">日期处理函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-汇总数据"><span class="toc-number">9.</span> <span class="toc-text">9. 汇总数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-分组数据"><span class="toc-number">10.</span> <span class="toc-text">10. 分组数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-子查询"><span class="toc-number">11.</span> <span class="toc-text">11. 子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#利用子查询过滤"><span class="toc-number">11.1.</span> <span class="toc-text">利用子查询过滤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#作为计算字段使用子查询"><span class="toc-number">11.2.</span> <span class="toc-text">作为计算字段使用子查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-联结表"><span class="toc-number">12.</span> <span class="toc-text">12. 联结表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-创建高级联结"><span class="toc-number">13.</span> <span class="toc-text">13. 创建高级联结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#表别名"><span class="toc-number">13.1.</span> <span class="toc-text">表别名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#不同类型的联结"><span class="toc-number">13.2.</span> <span class="toc-text">不同类型的联结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-组合查询"><span class="toc-number">14.</span> <span class="toc-text">14. 组合查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-插入数据"><span class="toc-number">15.</span> <span class="toc-text">15. 插入数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据插入"><span class="toc-number">15.1.</span> <span class="toc-text">数据插入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#插入完整行"><span class="toc-number">15.1.1.</span> <span class="toc-text">插入完整行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#插入部分行"><span class="toc-number">15.1.2.</span> <span class="toc-text">插入部分行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#插入检索出的数据"><span class="toc-number">15.1.3.</span> <span class="toc-text">插入检索出的数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#从一个表复制到另一个表-select-into"><span class="toc-number">15.2.</span> <span class="toc-text">从一个表复制到另一个表 (select into)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-更新和删除数据"><span class="toc-number">16.</span> <span class="toc-text">16. 更新和删除数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#更新数据-UPDATE"><span class="toc-number">16.1.</span> <span class="toc-text">更新数据 (UPDATE)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除数据-DELETE"><span class="toc-number">16.2.</span> <span class="toc-text">删除数据 (DELETE)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-创建和操纵表"><span class="toc-number">17.</span> <span class="toc-text">17. 创建和操纵表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建表-CREATE-TABLE"><span class="toc-number">17.1.</span> <span class="toc-text">创建表 (CREATE TABLE)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更新表-ALTER-TABLE"><span class="toc-number">17.2.</span> <span class="toc-text">更新表 (ALTER TABLE)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除表"><span class="toc-number">17.3.</span> <span class="toc-text">删除表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-使用视图"><span class="toc-number">18.</span> <span class="toc-text">18. 使用视图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-事务-TRANSACTION"><span class="toc-number">19.</span> <span class="toc-text">19. 事务 (TRANSACTION)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20-高级特性"><span class="toc-number">20.</span> <span class="toc-text">20. 高级特性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#约束-constraint"><span class="toc-number">20.1.</span> <span class="toc-text">约束 ( constraint )</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#主键-（PRIMARY-KEY）"><span class="toc-number">20.2.</span> <span class="toc-text">主键 （PRIMARY KEY）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#外键"><span class="toc-number">20.3.</span> <span class="toc-text">外键</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#索引-INDEX"><span class="toc-number">20.4.</span> <span class="toc-text">索引 ( INDEX )</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-SQLite数据类型"><span class="toc-number">21.</span> <span class="toc-text">21. SQLite数据类型</span></a></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(http://img5.imgtn.bdimg.com/it/u=2251006597,1398776092&amp;fm=26&amp;gp=0.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">GN</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">SQL必知必会</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-04-06 19:55:37"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-04-06</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-05-13 22:02:52"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-05-13</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/SQL/">SQL</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>评论数:</span><a href="/2020/04/06/sql/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2020/04/06/sql/" itemprop="commentCount"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h2 id="1-数据库基础"><a href="#1-数据库基础" class="headerlink" title="1. 数据库基础"></a>1. 数据库基础</h2><ul>
<li><p>数据库管理软件 （DBMS）</p>
</li>
<li><p>数据库 （database）</p>
</li>
<li><p>表 （table）</p>
</li>
<li><p>列 （column）</p>
</li>
<li><p>行 （row）</p>
</li>
<li><p>主键 （primary key）</p>
<p>应该总是定义主键，方便以后数据操作和管理。</p>
<p>表中任何列都可以作为主键，需要满足以下条件:</p>
<ul>
<li>任意两行都不具有相同的主键值</li>
<li>每一行都必须具有一个主键值 (主键列不允许NULL值)</li>
<li>主键列中的值不允许修改或更新</li>
<li>主键值不能重用（如果某行从表中删除，它的主键不能赋予给以后的新行）</li>
</ul>
<p>也可以多列一起使用作为主键</p>
</li>
</ul>
<h2 id="2-检索数据"><a href="#2-检索数据" class="headerlink" title="2. 检索数据"></a>2. 检索数据</h2><ul>
<li><p>SELECT</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 从Products表中查找prod_name列</span><br><span class="line"><span class="keyword">SELECT</span> prod_name </span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br><span class="line"></span><br><span class="line">// 多列</span><br><span class="line"><span class="keyword">SELECT</span> prod_id, prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br><span class="line"></span><br><span class="line">// 所有列</span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br></pre></td></tr></table></figure>
</li>
<li><p>DISTINCT</p>
<p>只检索不同的值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> vend_id</span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br></pre></td></tr></table></figure>
</li>
<li><p>LIMIT OFFSET</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 检索从第5行起的5行数据</span><br><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">5</span> <span class="keyword">OFFSET</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h2 id="3-排序检索数据"><a href="#3-排序检索数据" class="headerlink" title="3. 排序检索数据"></a>3. 排序检索数据</h2><ul>
<li><p>ORDER BY</p>
<p>order by 必须要保证是select语句中最后一条字句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_price, prod_name;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id, prod_price, prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">2</span>, <span class="number">3</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>DESC</p>
<p>降序排列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id, prod_price, prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_price <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h2 id="4-过滤数据"><a href="#4-过滤数据" class="headerlink" title="4. 过滤数据"></a>4. 过滤数据</h2><ul>
<li><p>WHERE</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price <span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> prod_price = <span class="number">3.49</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> prod_price <span class="keyword">BETWEEN</span> <span class="number">5</span> <span class="keyword">AND</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> prod_price <span class="keyword">IS</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<p>  <img src="/" class="lazyload" data-src="https://raw.githubusercontent.com/gaonian/HexoDocument/master/iOS/SQLite/sql_image/sql1.png"  alt="sql1"></p>
<h2 id="5-高级数据过滤"><a href="#5-高级数据过滤" class="headerlink" title="5. 高级数据过滤"></a>5. 高级数据过滤</h2><ul>
<li><p>AND</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> vend_id = <span class="string">'DLL01'</span> <span class="keyword">AND</span> prod_price &lt;= <span class="number">4</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>OR</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> vend_id = <span class="string">'DLL01'</span> <span class="keyword">OR</span> vend_id = ‘BRS01’;</span><br></pre></td></tr></table></figure>

<p>在使用AND OR 组合的时候，应使用小括号明确分组操作符</p>
</li>
<li><p>IN</p>
<p>IN 操作符用来指定条件范围，范围中的每个条件都可以进行匹配，IN 取值由都好分割，括在圆括号中的合法值。</p>
<p>where子句中用来指定要匹配值得清单的关键字，功能与OR相当</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> vend_id <span class="keyword">IN</span> ( <span class="string">'DLL01'</span>, <span class="string">'BRS01'</span> )</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br></pre></td></tr></table></figure>
</li>
<li><p>NOT</p>
<p>否定其后跟着的任何条件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> vend_id = <span class="string">'DLL01'</span> </span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_name;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h2 id="6-用通配符进行过滤"><a href="#6-用通配符进行过滤" class="headerlink" title="6. 用通配符进行过滤"></a>6. 用通配符进行过滤</h2><ul>
<li><p>LIKE</p>
<ul>
<li><p>%</p>
<p>%表示任何字符出现任意次数，例如寻找Fish开头的所有产品，可以用以下sql语句 %告诉DBMS接受Fish之后的任意字符，不管有多少字符</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id, prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> prod_name <span class="keyword">LIKE</span> <span class="string">'Fish%'</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> prod_name <span class="keyword">LIKE</span> <span class="string">'F%y'</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id, prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> prod_name <span class="keyword">LIKE</span> <span class="string">'%bean bag%'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>_</p>
<p>下划线 _ 只匹配单个字符，而不是多个字符</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id, prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> prod_name <span class="keyword">LIKE</span> <span class="string">'__ inch teddy bear'</span>;</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<p>sql的通配符很有用。但这种功能是有代价的，通配符搜索一般比其他搜索会消耗更长的处理事件。</p>
<ul>
<li>不要过度使用通配符。如果其他操作符能达到相同的目的，应该使用其他操作符</li>
<li>在确实需要使用通配符时，也尽量不要把他们用在搜索模式的开始，把通配符用在开始处，搜索起来是最慢的</li>
<li>仔细注意通配符的位置，如果放错地方，可能不会返回想要的数据</li>
</ul>
<h2 id="7-创建计算字段"><a href="#7-创建计算字段" class="headerlink" title="7. 创建计算字段"></a>7. 创建计算字段</h2><ul>
<li><p>||</p>
<p>如果想要使返回的值拼接在一起，在sqlite中可以使用 || 进行拼接两个列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_name || <span class="string">' ('</span> || vend_country || <span class="string">')'</span></span><br><span class="line"><span class="keyword">FROM</span> Vendors</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br></pre></td></tr></table></figure>
</li>
<li><p>RTRIM()函数</p>
<p>使用RTRIM函数去掉值右边的所有空格</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">RTRIM</span>(vend_name) || <span class="string">' ('</span> || <span class="keyword">RTRIM</span>(vend_country) || <span class="string">')'</span> <span class="keyword">FROM</span> Vendors</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br></pre></td></tr></table></figure>
</li>
<li><p>AS</p>
<p>别名（alias）。 通过拼接的字段并没有名字，对于客户端来说没法引用。</p>
<p>为了解决这个问题，sql支持列别名，别名是一个字段或值得替换名。别名用AS关键字赋予</p>
<p>别名有时也叫导出列（derived column）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">RTRIM</span>(vend_name) || <span class="string">' ('</span> || <span class="keyword">RTRIM</span>(vend_country) || <span class="string">')'</span> <span class="keyword">AS</span> vend_title</span><br><span class="line"><span class="keyword">FROM</span> Vendors</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> vend_name;</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行 + - * / 算术计算</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id,</span><br><span class="line">       quantity,</span><br><span class="line">			 item_price,</span><br><span class="line">       quantity*item_price <span class="keyword">AS</span> expanded_price</span><br><span class="line"><span class="keyword">FROM</span> OrderItems</span><br><span class="line"><span class="keyword">WHERE</span> order_num = <span class="number">20008</span>;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h2 id="8-使用函数处理数据"><a href="#8-使用函数处理数据" class="headerlink" title="8. 使用函数处理数据"></a>8. 使用函数处理数据</h2><h3 id="文本处理函数"><a href="#文本处理函数" class="headerlink" title="文本处理函数"></a>文本处理函数</h3><p><img src="/" class="lazyload" data-src="https://raw.githubusercontent.com/gaonian/HexoDocument/master/iOS/SQLite/sql_image/sql2.png"  alt=""></p>
<h3 id="数值处理函数"><a href="#数值处理函数" class="headerlink" title="数值处理函数"></a>数值处理函数</h3><p><img src="/" class="lazyload" data-src="https://raw.githubusercontent.com/gaonian/HexoDocument/master/iOS/SQLite/sql_image/sql3.png"  alt=""></p>
<h3 id="日期处理函数"><a href="#日期处理函数" class="headerlink" title="日期处理函数"></a>日期处理函数</h3><h2 id="9-汇总数据"><a href="#9-汇总数据" class="headerlink" title="9. 汇总数据"></a>9. 汇总数据</h2><ul>
<li><p>AVG()</p>
<p>AVG返回某列的平均值。也可以用来返回特定列或行的平均值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(prod_price) <span class="keyword">AS</span> avg_price</span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br></pre></td></tr></table></figure>
</li>
<li><p>COUNT()</p>
<p>COUNT()函数进行计数，可利用count()确定表中行的数目或符合特定条件的行的数目</p>
<p>COUNT()函数有两种使用方式</p>
<ul>
<li><p>使用 COUNT(*) 对表中行的数目进行计数，不管表列中包含的是空置（null）还是非空值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> num_cust</span><br><span class="line"><span class="keyword">FROM</span> Customers;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 COUNT(column) 对特定列中具有值的行进行计数，忽略NULL值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(cust_email) <span class="keyword">AS</span> num_cust</span><br><span class="line"><span class="keyword">FROM</span> Customers;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>MAX()</p>
<p>返回指定列中的最大值。MAX()要求指定列名。忽略列值为null的行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 返回Products表中最贵物品的价格</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(prod_price) <span class="keyword">AS</span> max_price</span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br></pre></td></tr></table></figure>
</li>
<li><p>MIN()</p>
<p>返回指定列的最小值，MIN()要求指定列名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MIN</span>(prod_price) <span class="keyword">AS</span> min_price</span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br></pre></td></tr></table></figure>
</li>
<li><p>SUM()</p>
<p>SUM()用来返回指定列值得和(总计)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(quantity) <span class="keyword">AS</span> items_ordered <span class="keyword">FROM</span> OrderItems</span><br><span class="line"><span class="keyword">WHERE</span> order_num = <span class="number">20005</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>DISTINCT</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(<span class="keyword">DISTINCT</span> prod_price) <span class="keyword">AS</span> avg_price <span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> vend_id = <span class="string">'DLL01'</span>;</span><br></pre></td></tr></table></figure>

<p>DISTINCT不用用于count(*)</p>
</li>
<li><p>可组合函数使用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> num_items,</span><br><span class="line">       <span class="keyword">MIN</span>(prod_price) <span class="keyword">AS</span> price_min,</span><br><span class="line">       <span class="keyword">MAX</span>(prod_price) <span class="keyword">AS</span> price_max,</span><br><span class="line">       <span class="keyword">AVG</span>(prod_price) <span class="keyword">AS</span> price_avg</span><br><span class="line"><span class="keyword">FROM</span> Products;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h2 id="10-分组数据"><a href="#10-分组数据" class="headerlink" title="10. 分组数据"></a>10. 分组数据</h2><ul>
<li><p>GROUP BY</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_id, <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> num_prods</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> vend_id;</span><br></pre></td></tr></table></figure>

<p>vend_id包含产品供应商的ID，num_prod为计算字段（用count(*)函数建立）。group by子句指示DBMS按vend_id排序并分组数据。</p>
<p>group by子句指示DBMS分组数据，然后对每个组而不是整个结果进行聚集。</p>
<p>group by子句必须出现在where子句之后，order by子句之前</p>
<p><img src="/" class="lazyload" data-src="https://raw.githubusercontent.com/gaonian/HexoDocument/master/iOS/SQLite/sql_image/sql4.png"  alt=""></p>
</li>
</ul>
<ul>
<li><p>HAVING</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_id, <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> orders <span class="keyword">FROM</span> Orders</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> cust_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(*) &gt;= <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>having过滤了两个订单以上的分组。</p>
<p>having和where非常相似，唯一区别是having可以用来过滤分组，而where只能过滤行。</p>
</li>
</ul>
<p><img src="/" class="lazyload" data-src="https://raw.githubusercontent.com/gaonian/HexoDocument/master/iOS/SQLite/sql_image/sql5.png"  alt=""></p>
<h2 id="11-子查询"><a href="#11-子查询" class="headerlink" title="11. 子查询"></a>11. 子查询</h2><h3 id="利用子查询过滤"><a href="#利用子查询过滤" class="headerlink" title="利用子查询过滤"></a>利用子查询过滤</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_id</span><br><span class="line"><span class="keyword">FROM</span> Orders</span><br><span class="line"><span class="keyword">WHERE</span> order_num <span class="keyword">IN</span> (<span class="keyword">SELECT</span> order_num</span><br><span class="line">                    <span class="keyword">FROM</span> OrderItems</span><br><span class="line">										<span class="keyword">WHERE</span> prod_id = <span class="string">'RGAN01'</span>);</span><br></pre></td></tr></table></figure>

<p>子查询总是由内向外处理。先处理子句，把子句的结果传递给外部查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> cust_id</span><br><span class="line">                  <span class="keyword">FROM</span> Orders</span><br><span class="line">                  <span class="keyword">WHERE</span> order_num <span class="keyword">IN</span> (<span class="keyword">SELECT</span> order_num</span><br><span class="line">                                      <span class="keyword">FROM</span> OrderItems</span><br><span class="line">																			<span class="keyword">WHERE</span> prod_id = <span class="string">'RGAN01'</span>));</span><br></pre></td></tr></table></figure>

<p>上面的sql实际上执行了三条select语句，最里边子查询返回订单号列表，此列表用于其外面的子查询的where子句。外面的子查询返回顾客ID列表，此顾客ID列表用于最外层查询的where子句。最外层查询返回所需的数据。</p>
<p>注意：子查询的select语句只能查询单个列，企图检索多个列会报错</p>
<h3 id="作为计算字段使用子查询"><a href="#作为计算字段使用子查询" class="headerlink" title="作为计算字段使用子查询"></a>作为计算字段使用子查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name,</span><br><span class="line">       cust_state,</span><br><span class="line">       (<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*)</span><br><span class="line">       <span class="keyword">FROM</span> Orders</span><br><span class="line">       <span class="keyword">WHERE</span> Orders.cust_id = Customers.cust_id) <span class="keyword">AS</span> orders</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> cust_name;</span><br></pre></td></tr></table></figure>

<p>这条select语句对Customers表中每个顾客返回三列：cust_name、cust_state和orders。orders是一个计算字段，它是由圆括号中的子查询建立的。该子查询对检索出的每个顾客执行一次。在此例中，该子查询执行了5此，因为检索出了5个顾客。</p>
<h2 id="12-联结表"><a href="#12-联结表" class="headerlink" title="12. 联结表"></a>12. 联结表</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_name, prod_name, prod_price </span><br><span class="line"><span class="keyword">FROM</span> Vendors, Products</span><br><span class="line"><span class="keyword">WHERE</span> Vendors.vend_id = Products.vend_id;</span><br></pre></td></tr></table></figure>

<p>vend_name字段存在于vendors表中，而prod_name和prod_price字段在同一个表（Products）中。</p>
<p>现在看FROM子句 ,与之前那select语句不一样,这条语句的FROM子句列出了两个表：Vendors和Products。它们就是这条select语句联结的两个表的名字。这两个表用where子句正确的联结，where子句指示DBMS将Vendors表中的vend_id与Products表中的vend_id匹配起来。 注意：需要完全限定列名</p>
<p>联结多个表: </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name, vend_name, prod_price, quantity </span><br><span class="line"><span class="keyword">FROM</span> OrderItems, Products, Vendors</span><br><span class="line"><span class="keyword">WHERE</span> Products.vend_id = Vendors.vend_id</span><br><span class="line"><span class="keyword">AND</span> OrderItems.prod_id = Products.prod_id </span><br><span class="line"><span class="keyword">AND</span> order_num = <span class="number">20007</span>;</span><br></pre></td></tr></table></figure>



<ul>
<li>INNER JOIN</li>
</ul>
<p>上面的等值联结基于两个表之间的相等测试。这种联结也成为内联结（inner join）。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> vend_name, prod_name, prod_price </span><br><span class="line"><span class="keyword">FROM</span> Vendors <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Products</span><br><span class="line"><span class="keyword">ON</span> Vendors.vend_id = Products.vend_id;</span><br></pre></td></tr></table></figure>

<p>此语句中select与前面的select语句相同，但from子句不同。这里，两个表之间的管你西是以 INNER JOIN 指定的部分FROM子句。在使用这种语法时，联结条件用特定的 ON 子句而不是 where子句。传递给 on 的实际条件与传递给 where 的相同。</p>
<h2 id="13-创建高级联结"><a href="#13-创建高级联结" class="headerlink" title="13. 创建高级联结"></a>13. 创建高级联结</h2><h3 id="表别名"><a href="#表别名" class="headerlink" title="表别名"></a>表别名</h3><p>sql除了可以对列名和计算字段使用别名，还允许给表名起别名。</p>
<ul>
<li>缩短sql语句</li>
<li>允许在一条select语句中多次使用相同的表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact</span><br><span class="line"><span class="keyword">FROM</span> Customers <span class="keyword">AS</span> C, Orders <span class="keyword">AS</span> O, OrderItems <span class="keyword">AS</span> OI </span><br><span class="line"><span class="keyword">WHERE</span> C.cust_id = O.cust_id</span><br><span class="line"><span class="keyword">AND</span> OI.order_num = O.order_num </span><br><span class="line"><span class="keyword">AND</span> prod_id = <span class="string">'RGAN01'</span>;</span><br></pre></td></tr></table></figure>

<p>表别名可以用在where子句、select的列表、order by子句以及其他语句部分</p>
<h3 id="不同类型的联结"><a href="#不同类型的联结" class="headerlink" title="不同类型的联结"></a>不同类型的联结</h3><ul>
<li><p>自联结 ( self-join )</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> c1.cust_id, c1.cust_name, c1.cust_contact </span><br><span class="line"><span class="keyword">FROM</span> Customers <span class="keyword">AS</span> c1, Customers <span class="keyword">AS</span> c2</span><br><span class="line"><span class="keyword">WHERE</span> c1.cust_name = c2.cust_name</span><br><span class="line"><span class="keyword">AND</span> c2.cust_contact = <span class="string">'Jim Jones'</span>;</span><br></pre></td></tr></table></figure>

<p>子查询方式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_id, cust_name, cust_contact </span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_name = (<span class="keyword">SELECT</span> cust_name</span><br><span class="line"> 									 <span class="keyword">FROM</span> Customers</span><br><span class="line">									 <span class="keyword">WHERE</span> cust_contact = <span class="string">'Jim Jones'</span>);</span><br></pre></td></tr></table></figure>

<p>两种方式查询出的结果一致，但是使用联结比子查询效率更高</p>
</li>
<li><p>外联结 ( outer join )</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Customers.cust_id, Orders.order_num </span><br><span class="line"><span class="keyword">FROM</span> Customers <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> Orders</span><br><span class="line"><span class="keyword">ON</span> Customers.cust_id = Orders.cust_id;</span><br></pre></td></tr></table></figure>

<p>外联结还包括没有关联行的行。在使用outer join预发时，必须使用right 或 left 关键字指定包括其所有行的表 （right指出的是outer join右边的表，left指出的是outer join左边的表）。上面的例子使用left outer join 从 from 子句左边的表（Customers 表）中选择所有行。为了从右边的表中选择所有行，需要使用right outer join。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Customers.cust_id, Orders.order_num </span><br><span class="line"><span class="keyword">FROM</span> Customers <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> Orders</span><br><span class="line"><span class="keyword">ON</span> Orders.cust_id = Customers.cust_id;</span><br></pre></td></tr></table></figure>

<p>外联结有两种形式：左外联结和右外联结。它们之间的唯一区别就是所关联表的顺序。调整from或where子句中表的顺序，左外联结可以转换为右外联结。因此，这两种你那个外联结可以互换使用。</p>
</li>
</ul>
<p>  还有一种联结，全外联结（full outer join）。它检索两个表中所有行并关联那些可以关联的行。( mysql 和 sqlite 不支持full outer join的语法 )</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Customers.cust_id, Orders.order_num </span><br><span class="line"><span class="keyword">FROM</span> Orders <span class="keyword">FULL</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> Customers</span><br><span class="line"><span class="keyword">ON</span> Orders.cust_id = Customers.cust_id;</span><br></pre></td></tr></table></figure>



<h2 id="14-组合查询"><a href="#14-组合查询" class="headerlink" title="14. 组合查询"></a>14. 组合查询</h2><ol>
<li><p>在一个查询中从不同的表返回数据结构</p>
</li>
<li><p>对一个表执行多个查询，按一个查询返回数据</p>
</li>
</ol>
<ul>
<li><p>UNION</p>
<p>利用union，可以将给出的多条select语句。组合成一个结果集返回</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact, cust_email</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_state <span class="keyword">IN</span> (<span class="string">'IL'</span>,<span class="string">'IN'</span>,<span class="string">'MI'</span>)</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact, cust_email</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_name = <span class="string">'Fun4All'</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact, cust_email</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_state <span class="keyword">IN</span> (<span class="string">'IL'</span>,<span class="string">'IN'</span>,<span class="string">'MI'</span>)</span><br><span class="line"><span class="keyword">OR</span> cust_name = <span class="string">'Fun4All'</span>;</span><br></pre></td></tr></table></figure>

<p>两条sql等价</p>
<p>union每个查询必须包含相同的列、表达式或聚集函数</p>
<p>union会默认过滤相同的行。如果想要展示重复的行，使用 union all</p>
</li>
</ul>
<h2 id="15-插入数据"><a href="#15-插入数据" class="headerlink" title="15. 插入数据"></a>15. 插入数据</h2><h3 id="数据插入"><a href="#数据插入" class="headerlink" title="数据插入"></a>数据插入</h3><p>INSERT 用来将行插入（或添加）到数据库表。插入有几种方式：</p>
<ul>
<li>插入完整的行</li>
<li>插入行的一部分</li>
<li>插入某些查询的结果</li>
</ul>
<h4 id="插入完整行"><a href="#插入完整行" class="headerlink" title="插入完整行"></a>插入完整行</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers(cust_id,</span><br><span class="line">                      cust_name,</span><br><span class="line">                      cust_address,</span><br><span class="line">                      cust_city,</span><br><span class="line">                      cust_state,</span><br><span class="line">                      cust_zip,</span><br><span class="line">                      cust_country,</span><br><span class="line">                      cust_contact,</span><br><span class="line">                      cust_email)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">'1000000006'</span>,</span><br><span class="line">       <span class="string">'Toy Land'</span>,</span><br><span class="line">       <span class="string">'123 Any Street'</span>,</span><br><span class="line">       <span class="string">'New York'</span>,</span><br><span class="line">       <span class="string">'NY'</span>,</span><br><span class="line">       <span class="string">'11111'</span>,</span><br><span class="line">       <span class="string">'USA'</span>,</span><br><span class="line">       <span class="literal">NULL</span>,</span><br><span class="line">       <span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure>

<p>不要使用没用明确给出列的insert语句。给出列能使sql代码继续发挥作用，即使表结构发生了变化。</p>
<p>values的数目必须正确。</p>
<ul>
<li>如果不提供列名，则必须给每个表列提供一个值</li>
<li>如果提供列名，则必须给列出的每个列一个值</li>
</ul>
<h4 id="插入部分行"><a href="#插入部分行" class="headerlink" title="插入部分行"></a>插入部分行</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers(cust_id,</span><br><span class="line">                      cust_name,</span><br><span class="line">                      cust_address,</span><br><span class="line">                      cust_city,</span><br><span class="line">                      cust_state,</span><br><span class="line">                      cust_zip,</span><br><span class="line">                      cust_country)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">'1000000006'</span>,</span><br><span class="line">       <span class="string">'Toy Land'</span>,</span><br><span class="line">       <span class="string">'123 Any Street'</span>,</span><br><span class="line">       <span class="string">'New York'</span>,</span><br><span class="line">       <span class="string">'NY'</span>,</span><br><span class="line">       <span class="string">'11111'</span>,</span><br><span class="line"><span class="string">'USA'</span>);</span><br></pre></td></tr></table></figure>

<p>如果表的定义允许，则可以在insert操作中省略某些列。省略的列必须满足以下某个条件</p>
<ul>
<li>该列定义为允许NULL值（无值或空值）</li>
<li>在表定义中给出默认值。表示不给出值，则使用默认值</li>
</ul>
<p>如果表中不允许有NULL值或默认值，却省略了表中的值。则报错插入不成功</p>
<h4 id="插入检索出的数据"><a href="#插入检索出的数据" class="headerlink" title="插入检索出的数据"></a>插入检索出的数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers(cust_id,</span><br><span class="line">                      cust_contact,</span><br><span class="line">                      cust_email,</span><br><span class="line">                      cust_name,</span><br><span class="line">                      cust_address,</span><br><span class="line">                      cust_city,</span><br><span class="line">                      cust_state,</span><br><span class="line">                      cust_zip,</span><br><span class="line">                      cust_country)</span><br><span class="line"><span class="keyword">SELECT</span> cust_id,</span><br><span class="line">       cust_contact,</span><br><span class="line">       cust_email,</span><br><span class="line">       cust_name,</span><br><span class="line">       cust_address,</span><br><span class="line">       cust_city,</span><br><span class="line">       cust_state,</span><br><span class="line">       cust_zip,</span><br><span class="line">       cust_country</span><br><span class="line"><span class="keyword">FROM</span> CustNew;</span><br></pre></td></tr></table></figure>

<p>将CustNew表中的数据插入到Customers表中</p>
<h3 id="从一个表复制到另一个表-select-into"><a href="#从一个表复制到另一个表-select-into" class="headerlink" title="从一个表复制到另一个表 (select into)"></a>从一个表复制到另一个表 (select into)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">INTO</span> CustCopy</span><br><span class="line"><span class="keyword">FROM</span> Customers;</span><br></pre></td></tr></table></figure>

<p>这条select语句创建一个名为CustCopy的新表，并把Customers表的内容复制到新表中。因为这里使用的是 select * ，所以将在CustCopy表中创建（并填充）与Customers表中的每一列相同的列。要想只复制部分的列，可以明确给出列名，而不是使用*通配符。</p>
<p>Mysql和sqlite的语法稍有不同，如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> CustCopy <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Customers;</span><br></pre></td></tr></table></figure>

<ul>
<li>任何select选项和子句都可以使用，包括 where和group by</li>
<li>可利用联结从多个表插入数据</li>
<li>不管从多少个表中检索数据，数据都只能插入到一个表中</li>
</ul>
<h2 id="16-更新和删除数据"><a href="#16-更新和删除数据" class="headerlink" title="16. 更新和删除数据"></a>16. 更新和删除数据</h2><h3 id="更新数据-UPDATE"><a href="#更新数据-UPDATE" class="headerlink" title="更新数据 (UPDATE)"></a>更新数据 (UPDATE)</h3><p>有两种使用update的方式：</p>
<ul>
<li>更新表中的特定行</li>
<li>更新表中的所有行</li>
</ul>
<p>在使用update的时候，一定要注意不能省略where子句</p>
<p>update由三部分组成：</p>
<ul>
<li>要更新的表</li>
<li>列名和它们的新值</li>
<li>确定要更新哪些行的过滤条件</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> Customers</span><br><span class="line"><span class="keyword">SET</span> cust_email = <span class="string">'kim@thetoystore.com'</span> </span><br><span class="line"><span class="keyword">WHERE</span> cust_id = <span class="string">'1000000005'</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> Customers</span><br><span class="line"><span class="keyword">SET</span> cust_contact = <span class="string">'Sam Roberts'</span>,</span><br><span class="line">		cust_email = <span class="string">'sam@toyland.com'</span> </span><br><span class="line"><span class="keyword">WHERE</span> cust_id = <span class="string">'1000000006'</span>;</span><br></pre></td></tr></table></figure>

<p>更新多个列时，只需要使用一条 SET 命令，每个“列=值” 对之间用逗号分隔。</p>
<p>要删除某个列的值，可设置它为NULL：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> Customers</span><br><span class="line"><span class="keyword">SET</span> cust_email = <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">WHERE</span> cust_id = <span class="string">'1000000005'</span>;</span><br></pre></td></tr></table></figure>

<h3 id="删除数据-DELETE"><a href="#删除数据-DELETE" class="headerlink" title="删除数据 (DELETE)"></a>删除数据 (DELETE)</h3><p>有两种使用DELETE的方式：</p>
<ul>
<li>从表中删除特定的行</li>
<li>从表中删除所有行</li>
</ul>
<p>使用delete的时候一定要注意不能省略where子句</p>
<p>delete只是删除表的内容，而不是删除表本身</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_id = <span class="string">'1000000006'</span>;</span><br></pre></td></tr></table></figure>



<h2 id="17-创建和操纵表"><a href="#17-创建和操纵表" class="headerlink" title="17. 创建和操纵表"></a>17. 创建和操纵表</h2><h3 id="创建表-CREATE-TABLE"><a href="#创建表-CREATE-TABLE" class="headerlink" title="创建表 (CREATE TABLE)"></a>创建表 (CREATE TABLE)</h3><p>必须给出下列信息：</p>
<ul>
<li>新表的名字。在关键字 CREATE TABLE 之后给出</li>
<li>表列的名字和定义，用逗号分隔</li>
<li>有的DBMS还要求指定表的位置</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders</span><br><span class="line">(</span><br><span class="line">  order_num <span class="built_in">INTEGER</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  order_date DATETIME <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  cust_id		<span class="built_in">CHAR</span>(<span class="number">10</span>)  <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="更新表-ALTER-TABLE"><a href="#更新表-ALTER-TABLE" class="headerlink" title="更新表 (ALTER TABLE)"></a>更新表 (ALTER TABLE)</h3><ul>
<li>在alter table 之后给出要更改的表名（该表必须存在，否则将出错）</li>
<li>列出要做哪些更改</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Vendors</span><br><span class="line"><span class="keyword">ADD</span> vend_phone <span class="built_in">CHAR</span>(<span class="number">20</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Vendors</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">COLUMN</span> vend_phone;</span><br></pre></td></tr></table></figure>

<p>也可以更改或删除列、增加约束或增加键</p>
<p>SQLite不支持使用ALTER TABLE定义主键和外键，这些必须在最初创建表时指定</p>
<h3 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> CustCopy;</span><br></pre></td></tr></table></figure>



<h2 id="18-使用视图"><a href="#18-使用视图" class="headerlink" title="18. 使用视图"></a>18. 使用视图</h2><ul>
<li>重用sql语句</li>
<li>简化复杂的sql操作。编写查询后，可以方便的重用它而不必知道其基本查询细节</li>
<li>使用表的一部分而不是整个表</li>
<li>保护数据。可以授予用户访问表的特定部分的权限，而不是整个表的访问权限</li>
<li>更改数据格式和表示。视图可返回与底层表的表示和格式不同的数据</li>
</ul>
<p>创建和使用的规则如下：</p>
<ul>
<li>与表一样，视图必须唯一命名</li>
<li>对于创建的视图数目没有限制</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> ProductCustomers <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact, prod_id </span><br><span class="line"><span class="keyword">FROM</span> Customers, Orders, OrderItems</span><br><span class="line"><span class="keyword">WHERE</span> Customers.cust_id = Orders.cust_id</span><br><span class="line"><span class="keyword">AND</span> OrderItems.order_num = Orders.order_num;</span><br></pre></td></tr></table></figure>

<p>这条语句创建一个名为ProductCustomers的视图，它联结三个表，返回已订购了任意产品的所有顾客的列表。如果执行select * from ProductCustomers，将列出订购了任意产品的顾客</p>
<p>检索订购了产品RGAN01的顾客，可如下进行：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, cust_contact </span><br><span class="line"><span class="keyword">FROM</span> ProductCustomers</span><br><span class="line"><span class="keyword">WHERE</span> prod_id = <span class="string">'RGAN01'</span>;</span><br></pre></td></tr></table></figure>

<p>这条语句通过where子句从视图中检索特定数据。当DBMS处理此查询时，它将制定的where子句添加到视图查询中已有的where子句中，以便正确过滤数据</p>
<h2 id="19-事务-TRANSACTION"><a href="#19-事务-TRANSACTION" class="headerlink" title="19. 事务 (TRANSACTION)"></a>19. 事务 (TRANSACTION)</h2><p>通过事务处理，确保成批的sql操作要么完全执行，要么完全不执行，来维护数据库的完整性</p>
<ul>
<li>事务（transaction）指一组sql语句</li>
<li>回退（rollback）指撤销指定sql语句的过程</li>
<li>提交（commit）指将未存储的sql语句结果写入数据库表</li>
<li>保留点（savepoint）指事务处理中设置的临时占位符，可以对它发布回退（与回退整个事务处理不同）</li>
</ul>
<p>事务处理用来管理insert、update和delete语句，不能回退select、create和drop操作</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span> <span class="keyword">TRANSACTION</span> </span><br><span class="line">...</span><br><span class="line"><span class="keyword">COMMIT</span> <span class="keyword">TRANSACTION</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ROLLBACK</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span> <span class="keyword">TRANSACTION</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customers(cust_id, cust_name) </span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">'1000000010'</span>, <span class="string">'Toys Emporium'</span>);</span><br><span class="line"></span><br><span class="line">SAVE TRANSACTION StartOrder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Orders(order_num, order_date, cust_id) <span class="keyword">VALUES</span>(<span class="number">20100</span>,<span class="string">'2001/12/1'</span>,<span class="string">'1000000010'</span>);</span><br><span class="line"></span><br><span class="line">IF @@ERROR &lt;&gt; 0 ROLLBACK TRANSACTION StartOrder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20100</span>, <span class="number">1</span>, <span class="string">'BR01'</span>, <span class="number">100</span>, <span class="number">5.49</span>);</span><br><span class="line"></span><br><span class="line">IF @@ERROR &lt;&gt; 0 ROLLBACK TRANSACTION StartOrder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> OrderItems(order_num, order_item, prod_id, quantity, item_price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20100</span>, <span class="number">2</span>, <span class="string">'BR03'</span>, <span class="number">100</span>, <span class="number">10.99</span>);</span><br><span class="line"></span><br><span class="line">IF @@ERROR &lt;&gt; 0 ROLLBACK TRANSACTION StartOrder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span> <span class="keyword">TRANSACTION</span></span><br></pre></td></tr></table></figure>



<h2 id="20-高级特性"><a href="#20-高级特性" class="headerlink" title="20. 高级特性"></a>20. 高级特性</h2><h3 id="约束-constraint"><a href="#约束-constraint" class="headerlink" title="约束 ( constraint )"></a>约束 ( constraint )</h3><p>管理如何插入或处理数据库数据的规则</p>
<h3 id="主键-（PRIMARY-KEY）"><a href="#主键-（PRIMARY-KEY）" class="headerlink" title="主键 （PRIMARY KEY）"></a>主键 （PRIMARY KEY）</h3><ul>
<li>任意两行的主键值都不相同</li>
<li>每行都具有一个主键值</li>
<li>包含主键值得列从不修改或更新</li>
<li>主键值不能重用。如果从表中删除某一行，其主键值不分配给新行</li>
</ul>
<h3 id="外键"><a href="#外键" class="headerlink" title="外键"></a>外键</h3><h3 id="索引-INDEX"><a href="#索引-INDEX" class="headerlink" title="索引 ( INDEX )"></a>索引 ( INDEX )</h3><ul>
<li>索引改善检索操作的性能，但降低了数据插入、修改和删除的性能。在执行这些操作时，DBMS必须动态更新索引</li>
<li>索引数据可能要占用大量的存储空间</li>
<li>并非所有数据都适合做索引。取值不多的数据没必要索引</li>
<li>索引用于数据过滤和数据排序。如果经常以某种特定的顺序排序数据，则该数据可能适合做索引</li>
<li>可以在索引中定义多个列</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> prod_name_ind</span><br><span class="line"><span class="keyword">ON</span> Products (prod_name);</span><br></pre></td></tr></table></figure>



<h2 id="21-SQLite数据类型"><a href="#21-SQLite数据类型" class="headerlink" title="21. SQLite数据类型"></a>21. SQLite数据类型</h2><p><a href="https://www.runoob.com/sqlite/sqlite-data-types.html" target="_blank" rel="noopener">https://www.runoob.com/sqlite/sqlite-data-types.html</a></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">GN</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://lmzcool.top/2020/04/06/sql/">http://lmzcool.top/2020/04/06/sql/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://lmzcool.top" target="_blank">GN</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://user-gold-cdn.xitu.io/2020/5/11/1720422da38055a1?w=500&amp;h=500&amp;f=png&amp;s=23846" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/04/10/image_assets/"><img class="prev_cover lazyload" data-src="https://raw.githubusercontent.com/gaonian/HexoDocument/master/iOS/assets_img/asset1.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">iOS图片移到assets问题记录</div></div></a></div><div class="next-post pull_right"><a href="/2020/04/06/SQLite%E5%B8%B8%E7%94%A8API(C)/"><img class="next_cover lazyload" data-src="http://img5.imgtn.bdimg.com/it/u=2251006597,1398776092&amp;fm=26&amp;gp=0.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">SQLite常用API（C）</div></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify: false,
  verify: false,
  appId: 'v26lyi3lmFjLAjSuqbPuAQWf-gzGzoHsz',
  appKey: 'kXNYMLXOoEDtuSEqWE7SadDa',
  placeholder: 'Please leave your footprints',
  avatar: 'monsterid',
  meta: guest_info,
  pageSize: '10',
  lang: 'zh-CN',
  recordIP: false,
  serverURLs: ''
});</script></div></article></main><footer id="footer" style="background-image: url(http://img5.imgtn.bdimg.com/it/u=2251006597,1398776092&amp;fm=26&amp;gp=0.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2015 - 2020 By GN</div><div class="icp"><a><img class="icp-icon" src="/img/icp.png"/><span>京ICP备19014027号</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>